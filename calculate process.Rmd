---
title: "p8105_hw5_zx2425"
output: github_document
---

```{r setup, include=FALSE}
library(tidyverse)
library(htmlwidgets)
library(flexdashboard)
library(p8105.datasets)
library(rvest)
library(readxl)
```

# Problem2
## step1
Describe the raw data. Create a city_state variable (e.g. “Baltimore, MD”) 

```{r}
hmcd =read.csv("./homicide-data.csv") %>% 
  janitor::clean_names() 
head(hmcd)
```
The data set has `r nrow(hmcd)` * ` r ncol(hmcd)` dimensions. Where uid describes the incident number, reported_date indicates the date and time, victim_last and victim first indicates the victim's name, and other data includes: race, age, gender, city, state, longitude, and latitude. And whether the incident was finally detected.

## step2
then summarize within cities to obtain the total number of homicides and the number of unsolved homicides (those for which the disposition is “Closed without arrest” or “Open/No arrest”).

```{r}
hmcd=hmcd %>% 
  mutate(
    city_state=str_c(city,"_",state)
  )

count_vic=hmcd %>% 
  group_by(city_state) %>% 
  summarize(
    vic_number=n()
  )
count_dect=hmcd %>% 
  filter(disposition %in% c("Closed without arrest", "Open/No arrest")) %>% 
  group_by(city_state) %>% 
  summarize(
    undec_number=n()
  )

count = full_join(count_vic,count_dect,by="city_state")
count[is.na(count)] = 0
```

## step3
For the city of __Baltimore, MD__, use the __prop.test__ function to estimate the proportion of homicides that are unsolved; save the output of prop.test as an R object, apply the __broom::tidy__ to this object and pull the _estimated_ _proportion_ and _confidence intervals_ from the resulting tidy dataframe.

```{r}
city_B= hmcd %>% 
  filter(city_state == 'Baltimore_MD')
city_B_count= city_B %>% 
   summarise(
      unsolved = sum(disposition %in%c("Closed without arrest", "Open/No arrest")  ),
      ###sum can calculate the True or false with result of number
      n = n()
    )
city_B_test = 
  prop.test(x = city_B_count %>% pull(unsolved),n = city_B_count %>% pull(n))
city_B_test %>% 
  broom::tidy() %>% 
  knitr::kable()  
  
```

